<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Telemetry and Metrics - Lockbox Extension</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  <link href="../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Telemetry and Metrics";
    var mkdocs_page_input_path = "metrics.md";
    var mkdocs_page_url = "/metrics/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Lockbox Extension</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../release-notes/">Release Notes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../faqs/">FAQs</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../contributing/">Contribute</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Telemetry and Metrics</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#lockbox-metrics-plan">Lockbox Metrics Plan</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#analysis">Analysis</a></li>
        
            <li><a class="toctree-l3" href="#collection">Collection</a></li>
        
            <li><a class="toctree-l3" href="#scalar-metrics">Scalar Metrics</a></li>
        
            <li><a class="toctree-l3" href="#list-of-events-currently-recorded">List of Events Currently Recorded</a></li>
        
            <li><a class="toctree-l3" href="#sketch-of-ios-telemetry-plan">Sketch of iOS Telemetry Plan</a></li>
        
            <li><a class="toctree-l3" href="#references">References</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Developer Guides</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../developer/install/">Build and Install</a>
                </li>
                <li class="">
                    
    <a class="" href="../developer/releases/">Release Instructions</a>
                </li>
                <li class="">
                    
    <a class="" href="../developer/test-plan/">Test Plan</a>
                </li>
                <li class="">
                    
    <a class="" href="../developer/test-plan-accessibility/">Test Plan - Accessibility</a>
                </li>
                <li class="">
                    
    <a class="" href="../developer/test-plan-telemetry/">Test Plan - Telemetry</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Lockbox Extension</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Telemetry and Metrics</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/mozilla-lockbox/lockbox-extension/edit/master/docs/metrics.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="lockbox-metrics-plan">Lockbox Metrics Plan</h1>
<p><em>Last Updated: Feb 19, 2018</em></p>
<!-- TOC depthFrom:2 depthTo:6 withLinks:1 updateOnSave:1 orderedList:0 -->

<ul>
<li><a href="#analysis">Analysis</a></li>
<li><a href="#collection">Collection</a><ul>
<li><a href="#event-registration-and-recording">Event Registration and Recording</a></li>
</ul>
</li>
<li><a href="#scalar-metrics">Scalar Metrics</a></li>
<li><a href="#list-of-events-currently-recorded">List of Events Currently Recorded</a></li>
<li><a href="#sketch-of-ios-telemetry-plan">Sketch of iOS Telemetry Plan</a></li>
<li><a href="#references">References</a></li>
</ul>
<!-- /TOC -->

<p>This is the metrics collection plan for Lockbox. It documents all events currently collected through telemetry, as well those planned for collection but not currently implemented. It will be updated periodically to reflect all new and planned data collection.</p>
<h2 id="analysis">Analysis</h2>
<p>Data collection is done solely for the purpose of product development, improvement and maintenance. Specifically, it is done to help its creators examine the validity of the following hypothesis.</p>
<p>Core Hypothesis: <strong>We believe that people want the browser to do more than only remember their passwords.</strong></p>
<p>We will know this to be true when:</p>
<ol>
<li>
<p>The password generator is clicked 20% of the time a new entry is created. <strong>This will indicate that users value the ability to create secure passwords.</strong> (Events regarding password generation will be added when feature development is complete)</p>
</li>
<li>
<p>75% of Lockbox downloads result in a Firefox account attached. <strong>This will indicate that users value secure storage for their credentials.</strong> We currently record the event <code>fxaUpgrade</code> to know whether a user has attached an Firefox account to their lockbox installation.</p>
</li>
<li>
<p>60% of users choose to import their existing credentials from Firefox into Lockbox. <strong>This will indicate that users trust lockbox more than the browser for managing their credentials.</strong> (Events regarding the importing of credentials from the firefox password manager will be added when feature development is complete)</p>
</li>
<li>
<p>We observe increased engagement with the management system (Create-Read-Update-Delete; CRUD) for users that import their credentials. <strong>This will indicate that users value greater visibility into the number of accounts that they have.</strong> We currently record <code>render</code> events when a user opens the credential manager.</p>
</li>
<li>
<p>CRUD usage rates are comparable to Firefox login manager usage prior to lockbox installation. <strong>This will indicate that users value Lockbox's credential management system, and use it to access credentials when they are needed.</strong> Firefox telemetry currently collects data on password autofill usage, which requires credentials be stored in the firefox password manager. We plan to compare lockbox credential usage (e.g. via the <code>usernameCopied</code> and <code>passwordCopied</code> lockbox events) to pre-lockbox autofill frequencies on a per-user basis.</p>
</li>
<li>
<p>20% of Lockbox users access their datastore on more than 1 device, <strong>indicating that users value having a single datastore of credentials.</strong></p>
</li>
</ol>
<p>Other questions we aim to answer through data collection, but are not directly related to the hypothesis above:</p>
<ul>
<li>Do people Save Passwords in Lockbox?<ul>
<li>How many? (measured by count of items saved per user)</li>
<li>How often? (number of credentials saved per user per time interval)</li>
</ul>
</li>
<li>Do people create their own passwords or use Lockbox to generate them?<ul>
<li>Ratio: (Number of times the PW generator is used when storing an item) / (number of credentials stored)</li>
</ul>
</li>
<li>When using the pw generator, do people create purely random passwords or customize them with their own input? (if this is going to be in the final design)</li>
<li>Do people use the passwords they store on Lockbox?<ul>
<li>How many times (per some unit of time) do stored credentials get filled?</li>
<li>How many times (per some unit of time) do stored credentials get copied?</li>
</ul>
</li>
<li>How many times do users click to reveal a password?</li>
<li>Do people continue to use Lockbox after first use?<ul>
<li>Out of those who install, how many use it more than once?</li>
</ul>
</li>
<li>Where are the drop-off points in the user flow?<ul>
<li>Do the majority of people make it all the way through the setup process?</li>
<li>Once initially setup, do people continue to add credentials?</li>
</ul>
</li>
<li>Do people sync their passwords between Firefox instances?<ul>
<li>How does syncing affect engagement?</li>
</ul>
</li>
</ul>
<h2 id="collection">Collection</h2>
<p>At this point, all measurements related to Lockbox will be made client-side. However, future releases will give users the option to sync their Lockbox data via an FxA account, at which point additional measurements will be logged server-side through the FxA data pipeline. We are not directly responsible for the measurements made through that mechanism.</p>
<p>For our internal alpha release, we will be making use of the public JavaScript API that allows recording and sending of event data and scalar data through an add-on. The API is documented here:</p>
<p>https://firefox-source-docs.mozilla.org/toolkit/components/telemetry/telemetry/collection/events.html#the-api</p>
<p>Once events are logged in the client they should appear in <a href="about:telemetry">about:telemetry</a>. From there they will be submitted in the main ping payload under <code>processes.dynamic.events</code> and available through the usual services (STMO and ATMO), as well as amplitude.</p>
<h3 id="event-registration-and-recording">Event Registration and Recording</h3>
<p>The events that we will record will conform to the structure expected by the telemetry pipeline. When the events are logged in telemetry they will be a list of:</p>
<p><code>[timestamp, category, method, object, value, extra]</code></p>
<p>The API takes care of the timestamp for us. We just need to define <code>category</code>, <code>method</code>, <code>object</code> and <code>extra</code> (<code>value</code> is optional and we won't use it).</p>
<p>Because we are using the API through an add-on it <strong>isn't</strong> necessary that we include an events.yaml file.</p>
<p>Instead we will define our events by <strong>registering</strong> them using a call to <code>Services.telemetry.registerEvents(category, eventData)</code>.</p>
<p>Here's a breakdown of how a to register a typical event:</p>
<pre><code class="javascript">Services.telemetry.registerEvents(&quot;event_category&quot;, {
    &quot;event_name&quot;: {
        methods: [&quot;click&quot;, ... ], // types of events that can occur
        objects: [&quot;a_button&quot;, ... ], // objects event can occur on
        extra: {&quot;key&quot;: &quot;value&quot;, ... } // key-value pairs (strings)
    }
</code></pre>

<p>For our purposes, we will use the <code>extra</code> field for a few purposes:</p>
<ul>
<li>To log the UUID of the item that has been added or changed (e.g. <code>"item_id": UUID</code>)</li>
<li>To log the fields that are modified when an item is updated in the datastore (e.g. <code>"fields": "password,notes"</code>  (because the value has to be a string we will have to concat the fields that were updated somehow)</li>
</ul>
<p>Once an event is registered, we can record it with:</p>
<p><code>Services.telemetry.recordEvent(category, method, object, null, extra)</code></p>
<p>When recording, we can use <code>null</code> for <code>value</code>.</p>
<p>See the Events section for specific examples of event registration and recording.</p>
<h4 id="scalar-recording">Scalar recording</h4>
<p>We use the js api for scalar recording as well. Here registration happens with the following syntax:</p>
<pre><code class="javascript">Services.telemetry.registerScalars(category, {
    &quot;scalar_name&quot;: {
        kind: services.Telemetry.SCALAR_TYPE_COUNT, // SCALAR_TYPE_COUNT, SCALAR_TYPE_BOOLEAN. or SCALAR_TYPE_STRING
        keyed: false,
        record_on_release: false, // NEEDS TO BE SET TO RECORD ON RELEASE CHANNEL
        expired: false,
    }
</code></pre>

<p>We set scalar values in the following way:</p>
<pre><code class="javascript">Services.telemetry.scalarSet(
    &quot;category.scalar_name&quot;, value
);
</code></pre>

<p>e.g. <code>lockboxV1.datastoreCount</code> for the scalar name.</p>
<p>We can also use <code>scalarAdd</code> to increment a scalar value by some amount.</p>
<h2 id="scalar-metrics">Scalar Metrics</h2>
<p>These are the metrics we currently collect regarding the state of user datastores.</p>
<ul>
<li><code>datastoreCount</code> (integer). Current count of the number of items in the user's datastore. Note that this scalar is only updated when the user renders their full item list, either in the management view or in the doorhanger. So when testing whether this scalar is accurately updated, please re-render the item list.</li>
</ul>
<h2 id="list-of-events-currently-recorded">List of Events Currently Recorded</h2>
<p>All events are currently implemented under the <strong>category: lockboxV2</strong>. The <code>extra</code> field contains <code>itemid</code> for events pertaining to a particular Lockbox item. They are listed and grouped together below based on the contents of the event's <code>method</code> field.</p>
<ol>
<li>
<p><code>startup</code> fires when the webextension is loaded. <strong>objects</strong>: webextension. Note that this event fires whenever the browser is started, so is not indicative of direct user interaction with Lockbox.</p>
</li>
<li>
<p><code>iconClick</code> fires when someone clicks the toolbar icon. <strong>objects</strong>: toolbar</p>
</li>
<li>
<p><code>render</code> events fire when the firstrun view (showing the initial Lockbox setup form), item manager or doorhanger (when implemented) are rendered. <strong>objects</strong>: firstrun, manage, doorhanger</p>
</li>
<li>
<p><code>itemAdding</code>, <code>itemUpdating</code>, <code>itemDeleting</code> fire when a user clicks to submit a new item or edit or delete an existing item. <strong>objects</strong>: addItemForm, updatingItemForm</p>
</li>
<li>
<p><code>itemAdded</code>, <code>itemUpdated</code>, <code>itemDeleted</code> fire after a successful add/update/delete action. <strong>objects</strong>: addItemForm, updatingItemForm</p>
</li>
<li>
<p><code>added</code>, <code>updated</code>, <code>deleted</code> fire when an item is added/updated/deleted in the backend datastore. Has itemid in the extra field. <strong>objects</strong>: datastore</p>
</li>
<li>
<p><code>itemSelected</code> fires when a user clicks an item in the itemlist. <strong>objects</strong> itemList  </p>
</li>
<li>
<p><code>usernameCopied</code> and <code>passwordCopied</code> fire when a user copies their username or password from an item. <strong>objects</strong>: itemDetails</p>
</li>
<li>
<p><code>feedbackClick</code> fires when the user clicks the "Send Feedback" button. <strong>objects</strong>: manage</p>
</li>
<li>
<p><code>faqClick</code> fires when the user clicks the "FAQ" button. <strong>objects</strong>: manage</p>
</li>
<li>
<p><code>resetRequested</code> fires when the user clicks the "Reset" button in the Lockbox settings. <strong>objects</strong>: settings</p>
</li>
<li>
<p><code>resetCompleted</code> fires when the user completes a reset of their Lockbox data in the Lockbox settings. <strong>objects</strong>: settings</p>
</li>
<li>
<p><code>fxaStart</code> fires when a user clicks the sign-in or sign-up button from the manager or firstrun screen. used to log user initiating fxa auth process. <strong>objects</strong>: welcomeSignin, manageAcctCreate, manageAcctSignin, unlockSignin</p>
</li>
<li>
<p><code>fxaAuth</code> has methods <code>fxaUpgrade</code>, <code>fxaSignin</code> and <code>fxaSignout</code> that fire when the user initially adds their fxa account to lockbox, signs in after having added their fxa account previously, or signs out of fxa. <strong>object</strong>: accounts</p>
</li>
<li>
<p><code>fxaFail</code> fires when the fxa process fails <strong>objects</strong>: accounts</p>
</li>
</ol>
<h2 id="sketch-of-ios-telemetry-plan">Sketch of iOS Telemetry Plan</h2>
<p>These events are based on the invisionapp design plan</p>
<ol>
<li>
<p><code>fxaStart</code> fires when a user taps the sign-in or sign-up button from the welcome screen. used to log user initiating fxa auth process.</p>
</li>
<li>
<p><code>fxaAuth</code> has methods <code>fxaSignin</code> and <code>fxaSignout</code> that fire when the user signs into or out of their fxa account.</p>
</li>
<li>
<p><code>touchIdEnabled</code>, <code>faceIdEnabled</code>, <code>touchIdSkipped</code>, <code>faceIdSkipped</code> fire when a user successfully authorizes the use of touchID/faceID to unlock lockbox or taps to skip.</p>
</li>
<li>
<p><code>browserEnabled</code> fires when user successfully adds lockbox integration to their browser. <strong>objects</strong>: <code>firefox</code>, <code>chrome</code>, <code>safari</code></p>
</li>
<li>
<p><code>usernameCopied</code> and <code>passwordCopied</code> fire when a user copies their username or password from an item. <strong>objects</strong>: itemList</p>
</li>
<li>
<p><code>itemSelected</code> fires when a user taps an item in the itemlist. <strong>objects</strong> itemList</p>
</li>
<li>
<p><code>itemShow</code> fires when a user taps to view item details in the itemlist. <strong>objects</strong> itemList</p>
</li>
<li>
<p><code>settingsTap</code> fires when a user taps an entry on the settings page. <strong>object</strong> will label the setting that was tapped</p>
</li>
<li>
<p><code>settingsChanged</code> fires when a user toggles a changeable setting. <strong>object</strong> will label the setting that was toggled</p>
</li>
<li>
<p><code>feedbackSent</code> Fires when a user sends feedback through the feedback form.</p>
</li>
</ol>
<hr />
<h2 id="references">References</h2>
<p>Docs for the Public JS API that allows us to log events thru an add-on:</p>
<p>https://firefox-source-docs.mozilla.org/toolkit/components/telemetry/telemetry/collection/events.html#the-api</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../developer/install/" class="btn btn-neutral float-right" title="Build and Install">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../contributing/" class="btn btn-neutral" title="Contribute"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/mozilla-lockbox/lockbox-extension/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../contributing/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../developer/install/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js"></script>
      <script src="../search/require.js"></script>
      <script src="../search/search.js"></script>

</body>
</html>
